# 계약 정보 포함 엑셀 업로드 가이드

## 📊 엑셀 템플릿 형식

### 공통 템플릿 (요일별/모든 요일 같은 시간 혼용 가능)

| name | phone | schedules | day_of_week | start_time | end_time | lesson | first_lesson_date | contract_type | week_count | unit_price | level | place | emergency_contact | memo |
|------|-------|-----------|-------------|------------|----------|--------|-------------------|---------------|------------|------------|-------|-------|-------------------|------|
| 홍길동 | 010-1234-5678 |  | 월,수,금 | 14:00 | 15:00 | 영어 | 2025-01-06 | 정규 | 3 | 40000 | 초급 | 강남역 | 010-9999-9999 | 메모 |
| 김철수 | 010-2222-3333 | 월(14:00-15:00),수(18:00-19:00) |  |  |  | 영어 | 2025-01-06 | 정규 | 2 | 50000 | 중급 | 홍대입구역 | 010-8888-8888 | 주2회 |
| 이영희 | 010-3333-4444 | 토(10:00-11:00) |  |  |  | 요가 | 2025-01-11 | 선착순 | 1 | 50000 | 고급 | 강남역 | 010-7777-7777 | 1회성 |

**특징:**
- 한 파일에서 schedules(요일별 다른 시간) 또는 day_of_week+start_time(모든 요일 같은 시간) 방식 모두 혼용 가능
- schedules가 있으면 schedules 우선, 없으면 day_of_week+start_time+end_time 사용
- week_count: 주당 횟수(정규는 실제 주당 횟수, 선착순/체험은 1)
- unit_price: 1회 단가(모든 계약 유형에서 필수)

---

## 📝 필드 설명

### 필수 필드
| 필드명 | 설명 | 예시 | 비고 |
|--------|------|------|------|
| name | 학생 이름 | 홍길동 | |
| phone | 전화번호 | 010-1234-5678 | 010으로 시작 |
| schedules **또는** day_of_week | 스케줄 정보 | 월(14:00-15:00) **또는** 월,수 | 둘 중 하나 필수 |
| start_time | 시작 시간 | 14:00 | day_of_week 사용 시 필수 |
| lesson | 레슨 종류 | 영어, 피아노, 요가 등 | |
| first_lesson_date | 첫 레슨 날짜 | 2025-01-06 | YYYY-MM-DD |
| contract_type | 계약 유형 | 정규, 선착순, 체험 | |
| week_count | 주당 횟수 | 2, 3, 1 | schedules가 있으면 자동 계산 가능, 없으면 필수 입력 |
| unit_price | 단가 | 40000, 50000 | 1회 기준 금액 |

### 선택 필드
| 필드명 | 설명 | 예시 |
|--------|------|------|
| end_time | 종료 시간 | 15:00 |
| level | 학생 레벨 | 초급, 중급, 고급 |
| place | 레슨 장소 | 강남역 스튜디오 |
| emergency_contact | 비상 연락처 | 010-9999-9999 |
| memo | 메모 | 특이사항 기재 |

---

## 💡 사용 예시

### 예시 1: 주 2회, 요일별 다른 시간
```
name: 홍길동
phone: 010-1234-5678
schedules: 월(18:00-19:00),수(20:00-21:00)
lesson: 영어
first_lesson_date: 2025-01-06
contract_type: 정규
week_count: 2
unit_price: 40000
```
→ 월요일 저녁 6시, 수요일 저녁 8시에 각각 8회씩 레슨

### 예시 2: 주 3회, 모두 같은 시간
```
name: 김철수
phone: 010-2222-3333
day_of_week: 월,수,금
start_time: 14:00
end_time: 15:00
lesson: 피아노
first_lesson_date: 2025-01-06
contract_type: 정규
week_count: 3
unit_price: 35000
```
→ 월/수/금 오후 2시에 각각 8회씩, 총 24회 레슨

### 예시 3: 선착순 레슨 (1회)
```
name: 이영희
phone: 010-3333-4444
schedules: 토(10:00-11:00)
lesson: 요가
first_lesson_date: 2025-01-11
contract_type: 선착순
week_count: 1
unit_price: 50000
```
→ 1회성 레슨

---

## ⚙️ 계약 타입별 처리

| 계약 타입 | 입력값 | 레슨 생성 방식 |
|----------|--------|----------------|
| 정규 레슨 | 정규, 정규레슨, REGULAR | week_count(주당 횟수)와 기간(주)으로 반복 생성 |
| 선착순 레슨 | 선착순, 선착순레슨, FIRSTCOME | 첫 스케줄로 1회만 생성 |
| 체험 레슨 | 상담, 체험, 상담/체험, TRIAL | 첫 스케줄로 1회만 생성 |

---

## 🗄️ 데이터베이스 구조

### StudentTutorContract (계약 메인)
- 계약 기본 정보 (학생, 튜터, 금액, 상태 등)
- 시작일, 종료일, 주당 횟수, 단가 등

### ContractSchedule (계약 스케줄)
- 계약별 요일/시간 정보
- 하나의 계약에 여러 스케줄 가능
- 예: 계약 #1 → 월요일 18:00-19:00, 수요일 20:00-21:00

### LessonReservation (개별 레슨)
- 실제 레슨 예약 건
- 스케줄 정보를 바탕으로 자동 생성

---

## 🎯 주요 개선 사항

1. **요일별 다른 시간 지원** ✅
   - 기존: 모든 요일 동일 시간만 가능
   - 개선: 월요일 6시, 수요일 8시 등 개별 설정 가능

2. **계약 스케줄 분리** ✅
   - ContractSchedule 엔티티로 별도 관리
   - 계약 변경 시 스케줄만 수정 가능

3. **하위 호환성 유지** ✅
   - 기존 방식(day_of_week + start_time)도 계속 사용 가능
   - 두 가지 방식 모두 한 파일에서 혼용 가능

4. **한글 요일 입력** ✅
   - 월, 화, 수, 목, 금, 토, 일 그대로 입력
   - 자동으로 숫자로 변환 (월=1, 화=2, ...)
